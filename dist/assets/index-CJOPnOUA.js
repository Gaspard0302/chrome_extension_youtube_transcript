import{M as fe,U as A,R as E,P as $,z as L,H as Q,a0 as ie,a1 as _e,O as ee,h as ye,a2 as ve,S as be,V as F,W as te,c as ce,k as we,o as p,a as o,b as R,$ as ne,q as y,l as S,D as ke,a3 as xe,_ as Ce,f as X,a4 as de,Y as se,u as K,r as he}from"./types-B0luv8fm.js";function Te({prompt:e,useLegacyFunctionCalling:n=!1,systemMessageMode:i="system"}){const d=[],u=[];for(const{role:c,content:t}of e)switch(c){case"system":{switch(i){case"system":{d.push({role:"system",content:t});break}case"developer":{d.push({role:"developer",content:t});break}case"remove":{u.push({type:"other",message:"system messages are removed for this model"});break}default:{const s=i;throw new Error(`Unsupported system message mode: ${s}`)}}break}case"user":{if(t.length===1&&t[0].type==="text"){d.push({role:"user",content:t[0].text});break}d.push({role:"user",content:t.map((s,a)=>{var l,_,m,f;switch(s.type){case"text":return{type:"text",text:s.text};case"image":return{type:"image_url",image_url:{url:s.image instanceof URL?s.image.toString():`data:${(l=s.mimeType)!=null?l:"image/jpeg"};base64,${ce(s.image)}`,detail:(m=(_=s.providerMetadata)==null?void 0:_.openai)==null?void 0:m.imageDetail}};case"file":{if(s.data instanceof URL)throw new A({functionality:"'File content parts with URL data' functionality not supported."});switch(s.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:s.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:s.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:(f=s.filename)!=null?f:`part-${a}.pdf`,file_data:`data:application/pdf;base64,${s.data}`}};default:throw new A({functionality:`File content part type ${s.mimeType} in user messages`})}}}})});break}case"assistant":{let s="";const a=[];for(const l of t)switch(l.type){case"text":{s+=l.text;break}case"tool-call":{a.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)}});break}}if(n){if(a.length>1)throw new A({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});d.push({role:"assistant",content:s,function_call:a.length>0?a[0].function:void 0})}else d.push({role:"assistant",content:s,tool_calls:a.length>0?a:void 0});break}case"tool":{for(const s of t)n?d.push({role:"function",name:s.toolName,content:JSON.stringify(s.result)}):d.push({role:"tool",tool_call_id:s.toolCallId,content:JSON.stringify(s.result)});break}default:{const s=c;throw new Error(`Unsupported role: ${s}`)}}return{messages:d,warnings:u}}function le(e){var n,i;return(i=(n=e==null?void 0:e.content)==null?void 0:n.map(({token:d,logprob:u,top_logprobs:c})=>({token:d,logprob:u,topLogprobs:c?c.map(({token:t,logprob:s})=>({token:t,logprob:s})):[]})))!=null?i:void 0}function z(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var oe=p({error:p({message:o(),type:o().nullish(),param:de().nullish(),code:K([o(),y()]).nullish()})}),D=Ce({errorSchema:oe,errorToMessage:e=>e.error.message});function G({id:e,model:n,created:i}){return{id:e??void 0,modelId:n??void 0,timestamp:i!=null?new Date(i*1e3):void 0}}function Ie({mode:e,useLegacyFunctionCalling:n=!1,structuredOutputs:i}){var d;const u=(d=e.tools)!=null&&d.length?e.tools:void 0,c=[];if(u==null)return{tools:void 0,tool_choice:void 0,toolWarnings:c};const t=e.toolChoice;if(n){const l=[];for(const m of u)m.type==="provider-defined"?c.push({type:"unsupported-tool",tool:m}):l.push({name:m.name,description:m.description,parameters:m.parameters});if(t==null)return{functions:l,function_call:void 0,toolWarnings:c};switch(t.type){case"auto":case"none":case void 0:return{functions:l,function_call:void 0,toolWarnings:c};case"required":throw new A({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:l,function_call:{name:t.toolName},toolWarnings:c}}}const s=[];for(const l of u)l.type==="provider-defined"?c.push({type:"unsupported-tool",tool:l}):s.push({type:"function",function:{name:l.name,description:l.description,parameters:l.parameters,strict:i?!0:void 0}});if(t==null)return{tools:s,tool_choice:void 0,toolWarnings:c};const a=t.type;switch(a){case"auto":case"none":case"required":return{tools:s,tool_choice:a,toolWarnings:c};case"tool":return{tools:s,tool_choice:{type:"function",function:{name:t.toolName}},toolWarnings:c};default:{const l=a;throw new A({functionality:`Unsupported tool choice type: ${l}`})}}}var Se=class{constructor(e,n,i){this.specificationVersion="v1",this.modelId=e,this.settings=n,this.config=i}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:Z(this.modelId)}get defaultObjectGenerationMode(){return Oe(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:n,maxTokens:i,temperature:d,topP:u,topK:c,frequencyPenalty:t,presencePenalty:s,stopSequences:a,responseFormat:l,seed:_,providerMetadata:m}){var f,C,v,h,g,r,b,I;const k=e.type,T=[];c!=null&&T.push({type:"unsupported-setting",setting:"topK"}),(l==null?void 0:l.type)==="json"&&l.schema!=null&&!this.supportsStructuredOutputs&&T.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const O=this.settings.useLegacyFunctionCalling;if(O&&this.settings.parallelToolCalls===!0)throw new A({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(O&&this.supportsStructuredOutputs)throw new A({functionality:"structuredOutputs with useLegacyFunctionCalling"});const{messages:N,warnings:w}=Te({prompt:n,useLegacyFunctionCalling:O,systemMessageMode:Ae(this.modelId)});T.push(...w);const x={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:i,temperature:d,top_p:u,frequency_penalty:t,presence_penalty:s,response_format:(l==null?void 0:l.type)==="json"?this.supportsStructuredOutputs&&l.schema!=null?{type:"json_schema",json_schema:{schema:l.schema,strict:!0,name:(f=l.name)!=null?f:"response",description:l.description}}:{type:"json_object"}:void 0,stop:a,seed:_,max_completion_tokens:(C=m==null?void 0:m.openai)==null?void 0:C.maxCompletionTokens,store:(v=m==null?void 0:m.openai)==null?void 0:v.store,metadata:(h=m==null?void 0:m.openai)==null?void 0:h.metadata,prediction:(g=m==null?void 0:m.openai)==null?void 0:g.prediction,reasoning_effort:(b=(r=m==null?void 0:m.openai)==null?void 0:r.reasoningEffort)!=null?b:this.settings.reasoningEffort,messages:N};switch(Z(this.modelId)?(x.temperature!=null&&(x.temperature=void 0,T.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),x.top_p!=null&&(x.top_p=void 0,T.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),x.frequency_penalty!=null&&(x.frequency_penalty=void 0,T.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),x.presence_penalty!=null&&(x.presence_penalty=void 0,T.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),x.logit_bias!=null&&(x.logit_bias=void 0,T.push({type:"other",message:"logitBias is not supported for reasoning models"})),x.logprobs!=null&&(x.logprobs=void 0,T.push({type:"other",message:"logprobs is not supported for reasoning models"})),x.top_logprobs!=null&&(x.top_logprobs=void 0,T.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),x.max_tokens!=null&&(x.max_completion_tokens==null&&(x.max_completion_tokens=x.max_tokens),x.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&x.temperature!=null&&(x.temperature=void 0,T.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),k){case"regular":{const{tools:J,tool_choice:V,functions:B,function_call:H,toolWarnings:P}=Ie({mode:e,useLegacyFunctionCalling:O,structuredOutputs:this.supportsStructuredOutputs});return{args:{...x,tools:J,tool_choice:V,functions:B,function_call:H},warnings:[...T,...P]}}case"object-json":return{args:{...x,response_format:this.supportsStructuredOutputs&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:(I=e.name)!=null?I:"response",description:e.description}}:{type:"json_object"}},warnings:T};case"object-tool":return{args:O?{...x,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...x,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:T};default:{const J=k;throw new Error(`Unsupported type: ${J}`)}}}async doGenerate(e){var n,i,d,u,c,t,s,a;const{args:l,warnings:_}=this.getArgs(e),{responseHeaders:m,value:f,rawValue:C}=await E({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:$(this.config.headers(),e.headers),body:l,failedResponseHandler:D,successfulResponseHandler:F(Re),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:v,...h}=l,g=f.choices[0],r=(n=f.usage)==null?void 0:n.completion_tokens_details,b=(i=f.usage)==null?void 0:i.prompt_tokens_details,I={openai:{}};return(r==null?void 0:r.reasoning_tokens)!=null&&(I.openai.reasoningTokens=r==null?void 0:r.reasoning_tokens),(r==null?void 0:r.accepted_prediction_tokens)!=null&&(I.openai.acceptedPredictionTokens=r==null?void 0:r.accepted_prediction_tokens),(r==null?void 0:r.rejected_prediction_tokens)!=null&&(I.openai.rejectedPredictionTokens=r==null?void 0:r.rejected_prediction_tokens),(b==null?void 0:b.cached_tokens)!=null&&(I.openai.cachedPromptTokens=b==null?void 0:b.cached_tokens),{text:(d=g.message.content)!=null?d:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&g.message.function_call?[{toolCallType:"function",toolCallId:L(),toolName:g.message.function_call.name,args:g.message.function_call.arguments}]:(u=g.message.tool_calls)==null?void 0:u.map(k=>{var T;return{toolCallType:"function",toolCallId:(T=k.id)!=null?T:L(),toolName:k.function.name,args:k.function.arguments}}),finishReason:z(g.finish_reason),usage:{promptTokens:(t=(c=f.usage)==null?void 0:c.prompt_tokens)!=null?t:NaN,completionTokens:(a=(s=f.usage)==null?void 0:s.completion_tokens)!=null?a:NaN},rawCall:{rawPrompt:v,rawSettings:h},rawResponse:{headers:m,body:C},request:{body:JSON.stringify(l)},response:G(f),warnings:_,logprobs:le(g.logprobs),providerMetadata:I}}async doStream(e){if(this.settings.simulateStreaming){const h=await this.doGenerate(e);return{stream:new ReadableStream({start(r){if(r.enqueue({type:"response-metadata",...h.response}),h.text&&r.enqueue({type:"text-delta",textDelta:h.text}),h.toolCalls)for(const b of h.toolCalls)r.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:b.toolCallId,toolName:b.toolName,argsTextDelta:b.args}),r.enqueue({type:"tool-call",...b});r.enqueue({type:"finish",finishReason:h.finishReason,usage:h.usage,logprobs:h.logprobs,providerMetadata:h.providerMetadata}),r.close()}}),rawCall:h.rawCall,rawResponse:h.rawResponse,warnings:h.warnings}}const{args:n,warnings:i}=this.getArgs(e),d={...n,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:u,value:c}=await E({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:$(this.config.headers(),e.headers),body:d,failedResponseHandler:D,successfulResponseHandler:te(Me),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:t,...s}=n,a=[];let l="unknown",_={promptTokens:void 0,completionTokens:void 0},m,f=!0;const{useLegacyFunctionCalling:C}=this.settings,v={openai:{}};return{stream:c.pipeThrough(new TransformStream({transform(h,g){var r,b,I,k,T,O,N,w,x,J,V,B;if(!h.success){l="error",g.enqueue({type:"error",error:h.error});return}const H=h.value;if("error"in H){l="error",g.enqueue({type:"error",error:H.error});return}if(f&&(f=!1,g.enqueue({type:"response-metadata",...G(H)})),H.usage!=null){const{prompt_tokens:q,completion_tokens:U,prompt_tokens_details:j,completion_tokens_details:M}=H.usage;_={promptTokens:q??void 0,completionTokens:U??void 0},(M==null?void 0:M.reasoning_tokens)!=null&&(v.openai.reasoningTokens=M==null?void 0:M.reasoning_tokens),(M==null?void 0:M.accepted_prediction_tokens)!=null&&(v.openai.acceptedPredictionTokens=M==null?void 0:M.accepted_prediction_tokens),(M==null?void 0:M.rejected_prediction_tokens)!=null&&(v.openai.rejectedPredictionTokens=M==null?void 0:M.rejected_prediction_tokens),(j==null?void 0:j.cached_tokens)!=null&&(v.openai.cachedPromptTokens=j==null?void 0:j.cached_tokens)}const P=H.choices[0];if((P==null?void 0:P.finish_reason)!=null&&(l=z(P.finish_reason)),(P==null?void 0:P.delta)==null)return;const W=P.delta;W.content!=null&&g.enqueue({type:"text-delta",textDelta:W.content});const Y=le(P==null?void 0:P.logprobs);Y!=null&&Y.length&&(m===void 0&&(m=[]),m.push(...Y));const ae=C&&W.function_call!=null?[{type:"function",id:L(),function:W.function_call,index:0}]:W.tool_calls;if(ae!=null)for(const q of ae){const U=q.index;if(a[U]==null){if(q.type!=="function")throw new Q({data:q,message:"Expected 'function' type."});if(q.id==null)throw new Q({data:q,message:"Expected 'id' to be a string."});if(((r=q.function)==null?void 0:r.name)==null)throw new Q({data:q,message:"Expected 'function.name' to be a string."});a[U]={id:q.id,type:"function",function:{name:q.function.name,arguments:(b=q.function.arguments)!=null?b:""},hasFinished:!1};const M=a[U];((I=M.function)==null?void 0:I.name)!=null&&((k=M.function)==null?void 0:k.arguments)!=null&&(M.function.arguments.length>0&&g.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:M.id,toolName:M.function.name,argsTextDelta:M.function.arguments}),ie(M.function.arguments)&&(g.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(T=M.id)!=null?T:L(),toolName:M.function.name,args:M.function.arguments}),M.hasFinished=!0));continue}const j=a[U];j.hasFinished||(((O=q.function)==null?void 0:O.arguments)!=null&&(j.function.arguments+=(w=(N=q.function)==null?void 0:N.arguments)!=null?w:""),g.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:j.id,toolName:j.function.name,argsTextDelta:(x=q.function.arguments)!=null?x:""}),((J=j.function)==null?void 0:J.name)!=null&&((V=j.function)==null?void 0:V.arguments)!=null&&ie(j.function.arguments)&&(g.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(B=j.id)!=null?B:L(),toolName:j.function.name,args:j.function.arguments}),j.hasFinished=!0))}},flush(h){var g,r;h.enqueue({type:"finish",finishReason:l,logprobs:m,usage:{promptTokens:(g=_.promptTokens)!=null?g:NaN,completionTokens:(r=_.completionTokens)!=null?r:NaN},...v!=null?{providerMetadata:v}:{}})}})),rawCall:{rawPrompt:t,rawSettings:s},rawResponse:{headers:u},request:{body:JSON.stringify(d)},warnings:i}}},me=p({prompt_tokens:y().nullish(),completion_tokens:y().nullish(),prompt_tokens_details:p({cached_tokens:y().nullish()}).nullish(),completion_tokens_details:p({reasoning_tokens:y().nullish(),accepted_prediction_tokens:y().nullish(),rejected_prediction_tokens:y().nullish()}).nullish()}).nullish(),Re=p({id:o().nullish(),created:y().nullish(),model:o().nullish(),choices:R(p({message:p({role:S("assistant").nullish(),content:o().nullish(),function_call:p({arguments:o(),name:o()}).nullish(),tool_calls:R(p({id:o().nullish(),type:S("function"),function:p({name:o(),arguments:o()})})).nullish()}),index:y(),logprobs:p({content:R(p({token:o(),logprob:y(),top_logprobs:R(p({token:o(),logprob:y()}))})).nullable()}).nullish(),finish_reason:o().nullish()})),usage:me}),Me=K([p({id:o().nullish(),created:y().nullish(),model:o().nullish(),choices:R(p({delta:p({role:se(["assistant"]).nullish(),content:o().nullish(),function_call:p({name:o().optional(),arguments:o().optional()}).nullish(),tool_calls:R(p({index:y(),id:o().nullish(),type:S("function").nullish(),function:p({name:o().nullish(),arguments:o().nullish()})})).nullish()}).nullish(),logprobs:p({content:R(p({token:o(),logprob:y(),top_logprobs:R(p({token:o(),logprob:y()}))})).nullable()}).nullish(),finish_reason:o().nullish(),index:y()})),usage:me}),oe]);function Z(e){return e.startsWith("o")||e.startsWith("gpt-5")}function Oe(e){return e.startsWith("gpt-4o-audio-preview")}function Ae(e){var n,i;return Z(e)?(i=(n=qe[e])==null?void 0:n.systemMessageMode)!=null?i:"developer":"system"}var qe={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function je({prompt:e,inputFormat:n,user:i="user",assistant:d="assistant"}){if(n==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let u="";e[0].role==="system"&&(u+=`${e[0].content}

`,e=e.slice(1));for(const{role:c,content:t}of e)switch(c){case"system":throw new we({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const s=t.map(a=>{switch(a.type){case"text":return a.text;case"image":throw new A({functionality:"images"})}}).join("");u+=`${i}:
${s}

`;break}case"assistant":{const s=t.map(a=>{switch(a.type){case"text":return a.text;case"tool-call":throw new A({functionality:"tool-call messages"})}}).join("");u+=`${d}:
${s}

`;break}case"tool":throw new A({functionality:"tool messages"});default:{const s=c;throw new Error(`Unsupported role: ${s}`)}}return u+=`${d}:
`,{prompt:u,stopSequences:[`
${i}:`]}}function re(e){return e==null?void 0:e.tokens.map((n,i)=>({token:n,logprob:e.token_logprobs[i],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[i]).map(([d,u])=>({token:d,logprob:u})):[]}))}var Ne=class{constructor(e,n,i){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=n,this.config=i}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:n,prompt:i,maxTokens:d,temperature:u,topP:c,topK:t,frequencyPenalty:s,presencePenalty:a,stopSequences:l,responseFormat:_,seed:m}){var f;const C=e.type,v=[];t!=null&&v.push({type:"unsupported-setting",setting:"topK"}),_!=null&&_.type!=="text"&&v.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:h,stopSequences:g}=je({prompt:i,inputFormat:n}),r=[...g??[],...l??[]],b={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:d,temperature:u,top_p:c,frequency_penalty:s,presence_penalty:a,seed:m,prompt:h,stop:r.length>0?r:void 0};switch(C){case"regular":{if((f=e.tools)!=null&&f.length)throw new A({functionality:"tools"});if(e.toolChoice)throw new A({functionality:"toolChoice"});return{args:b,warnings:v}}case"object-json":throw new A({functionality:"object-json mode"});case"object-tool":throw new A({functionality:"object-tool mode"});default:{const I=C;throw new Error(`Unsupported type: ${I}`)}}}async doGenerate(e){const{args:n,warnings:i}=this.getArgs(e),{responseHeaders:d,value:u,rawValue:c}=await E({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:$(this.config.headers(),e.headers),body:n,failedResponseHandler:D,successfulResponseHandler:F(Pe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:t,...s}=n,a=u.choices[0];return{text:a.text,usage:{promptTokens:u.usage.prompt_tokens,completionTokens:u.usage.completion_tokens},finishReason:z(a.finish_reason),logprobs:re(a.logprobs),rawCall:{rawPrompt:t,rawSettings:s},rawResponse:{headers:d,body:c},response:G(u),warnings:i,request:{body:JSON.stringify(n)}}}async doStream(e){const{args:n,warnings:i}=this.getArgs(e),d={...n,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:u,value:c}=await E({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:$(this.config.headers(),e.headers),body:d,failedResponseHandler:D,successfulResponseHandler:te($e),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:t,...s}=n;let a="unknown",l={promptTokens:Number.NaN,completionTokens:Number.NaN},_,m=!0;return{stream:c.pipeThrough(new TransformStream({transform(f,C){if(!f.success){a="error",C.enqueue({type:"error",error:f.error});return}const v=f.value;if("error"in v){a="error",C.enqueue({type:"error",error:v.error});return}m&&(m=!1,C.enqueue({type:"response-metadata",...G(v)})),v.usage!=null&&(l={promptTokens:v.usage.prompt_tokens,completionTokens:v.usage.completion_tokens});const h=v.choices[0];(h==null?void 0:h.finish_reason)!=null&&(a=z(h.finish_reason)),(h==null?void 0:h.text)!=null&&C.enqueue({type:"text-delta",textDelta:h.text});const g=re(h==null?void 0:h.logprobs);g!=null&&g.length&&(_===void 0&&(_=[]),_.push(...g))},flush(f){f.enqueue({type:"finish",finishReason:a,logprobs:_,usage:l})}})),rawCall:{rawPrompt:t,rawSettings:s},rawResponse:{headers:u},warnings:i,request:{body:JSON.stringify(d)}}}},Pe=p({id:o().nullish(),created:y().nullish(),model:o().nullish(),choices:R(p({text:o(),finish_reason:o(),logprobs:p({tokens:R(o()),token_logprobs:R(y()),top_logprobs:R(he(o(),y())).nullable()}).nullish()})),usage:p({prompt_tokens:y(),completion_tokens:y()})}),$e=K([p({id:o().nullish(),created:y().nullish(),model:o().nullish(),choices:R(p({text:o(),finish_reason:o().nullish(),index:y(),logprobs:p({tokens:R(o()),token_logprobs:R(y()),top_logprobs:R(he(o(),y())).nullable()}).nullish()})),usage:p({prompt_tokens:y(),completion_tokens:y()}).nullish()}),oe]),De=class{constructor(e,n,i){this.specificationVersion="v1",this.modelId=e,this.settings=n,this.config=i}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.settings.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:n,abortSignal:i}){if(e.length>this.maxEmbeddingsPerCall)throw new _e({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:d,value:u}=await E({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:$(this.config.headers(),n),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:D,successfulResponseHandler:F(Ee),abortSignal:i,fetch:this.config.fetch});return{embeddings:u.data.map(c=>c.embedding),usage:u.usage?{tokens:u.usage.prompt_tokens}:void 0,rawResponse:{headers:d}}}},Ee=p({data:R(p({embedding:R(y())})),usage:p({prompt_tokens:y()}).nullish()}),He={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},Ue=new Set(["gpt-image-1"]),Le=class{constructor(e,n,i){this.modelId=e,this.settings=n,this.config=i,this.specificationVersion="v1"}get maxImagesPerCall(){var e,n;return(n=(e=this.settings.maxImagesPerCall)!=null?e:He[this.modelId])!=null?n:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n,size:i,aspectRatio:d,seed:u,providerOptions:c,headers:t,abortSignal:s}){var a,l,_,m;const f=[];d!=null&&f.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),u!=null&&f.push({type:"unsupported-setting",setting:"seed"});const C=(_=(l=(a=this.config._internal)==null?void 0:a.currentDate)==null?void 0:l.call(a))!=null?_:new Date,{value:v,responseHeaders:h}=await E({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:$(this.config.headers(),t),body:{model:this.modelId,prompt:e,n,size:i,...(m=c.openai)!=null?m:{},...Ue.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:D,successfulResponseHandler:F(Je),abortSignal:s,fetch:this.config.fetch});return{images:v.data.map(g=>g.b64_json),warnings:f,response:{timestamp:C,modelId:this.modelId,headers:h}}}},Je=p({data:R(p({b64_json:o()}))}),Fe=p({include:R(o()).nullish(),language:o().nullish(),prompt:o().nullish(),temperature:y().min(0).max(1).nullish().default(0),timestampGranularities:R(se(["word","segment"])).nullish().default(["segment"])}),ue={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},We=class{constructor(e,n){this.modelId=e,this.config=n,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:n,providerOptions:i}){var d,u,c,t,s;const a=[],l=ee({provider:"openai",providerOptions:i,schema:Fe}),_=new FormData,m=e instanceof Uint8Array?new Blob([e]):new Blob([ye(e)]);if(_.append("model",this.modelId),_.append("file",new File([m],"audio",{type:n})),l){const f={include:(d=l.include)!=null?d:void 0,language:(u=l.language)!=null?u:void 0,prompt:(c=l.prompt)!=null?c:void 0,temperature:(t=l.temperature)!=null?t:void 0,timestamp_granularities:(s=l.timestampGranularities)!=null?s:void 0};for(const C in f){const v=f[C];v!==void 0&&_.append(C,String(v))}}return{formData:_,warnings:a}}async doGenerate(e){var n,i,d,u,c,t;const s=(d=(i=(n=this.config._internal)==null?void 0:n.currentDate)==null?void 0:i.call(n))!=null?d:new Date,{formData:a,warnings:l}=this.getArgs(e),{value:_,responseHeaders:m,rawValue:f}=await ve({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:$(this.config.headers(),e.headers),formData:a,failedResponseHandler:D,successfulResponseHandler:F(Ve),abortSignal:e.abortSignal,fetch:this.config.fetch}),C=_.language!=null&&_.language in ue?ue[_.language]:void 0;return{text:_.text,segments:(c=(u=_.words)==null?void 0:u.map(v=>({text:v.word,startSecond:v.start,endSecond:v.end})))!=null?c:[],language:C,durationInSeconds:(t=_.duration)!=null?t:void 0,warnings:l,response:{timestamp:s,modelId:this.modelId,headers:m,body:f}}}},Ve=p({text:o(),language:o().nullish(),duration:y().nullish(),words:R(p({word:o(),start:y(),end:y()})).nullish()});function Be({prompt:e,systemMessageMode:n}){const i=[],d=[];for(const{role:u,content:c}of e)switch(u){case"system":{switch(n){case"system":{i.push({role:"system",content:c});break}case"developer":{i.push({role:"developer",content:c});break}case"remove":{d.push({type:"other",message:"system messages are removed for this model"});break}default:{const t=n;throw new Error(`Unsupported system message mode: ${t}`)}}break}case"user":{i.push({role:"user",content:c.map((t,s)=>{var a,l,_,m;switch(t.type){case"text":return{type:"input_text",text:t.text};case"image":return{type:"input_image",image_url:t.image instanceof URL?t.image.toString():`data:${(a=t.mimeType)!=null?a:"image/jpeg"};base64,${ce(t.image)}`,detail:(_=(l=t.providerMetadata)==null?void 0:l.openai)==null?void 0:_.imageDetail};case"file":{if(t.data instanceof URL)throw new A({functionality:"File URLs in user messages"});switch(t.mimeType){case"application/pdf":return{type:"input_file",filename:(m=t.filename)!=null?m:`part-${s}.pdf`,file_data:`data:application/pdf;base64,${t.data}`};default:throw new A({functionality:"Only PDF files are supported in user messages"})}}}})});break}case"assistant":{for(const t of c)switch(t.type){case"text":{i.push({role:"assistant",content:[{type:"output_text",text:t.text}]});break}case"tool-call":{i.push({type:"function_call",call_id:t.toolCallId,name:t.toolName,arguments:JSON.stringify(t.args)});break}}break}case"tool":{for(const t of c)i.push({type:"function_call_output",call_id:t.toolCallId,output:JSON.stringify(t.result)});break}default:{const t=u;throw new Error(`Unsupported role: ${t}`)}}return{messages:i,warnings:d}}function pe({finishReason:e,hasToolCalls:n}){switch(e){case void 0:case null:return n?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return n?"tool-calls":"unknown"}}function ze({mode:e,strict:n}){var i;const d=(i=e.tools)!=null&&i.length?e.tools:void 0,u=[];if(d==null)return{tools:void 0,tool_choice:void 0,toolWarnings:u};const c=e.toolChoice,t=[];for(const a of d)switch(a.type){case"function":t.push({type:"function",name:a.name,description:a.description,parameters:a.parameters,strict:n?!0:void 0});break;case"provider-defined":switch(a.id){case"openai.web_search_preview":t.push({type:"web_search_preview",search_context_size:a.args.searchContextSize,user_location:a.args.userLocation});break;default:u.push({type:"unsupported-tool",tool:a});break}break;default:u.push({type:"unsupported-tool",tool:a});break}if(c==null)return{tools:t,tool_choice:void 0,toolWarnings:u};const s=c.type;switch(s){case"auto":case"none":case"required":return{tools:t,tool_choice:s,toolWarnings:u};case"tool":return c.toolName==="web_search_preview"?{tools:t,tool_choice:{type:"web_search_preview"},toolWarnings:u}:{tools:t,tool_choice:{type:"function",name:c.toolName},toolWarnings:u};default:{const a=s;throw new A({functionality:`Unsupported tool choice type: ${a}`})}}}var Ge=class{constructor(e,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=e,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:n,temperature:i,stopSequences:d,topP:u,topK:c,presencePenalty:t,frequencyPenalty:s,seed:a,prompt:l,providerMetadata:_,responseFormat:m}){var f,C,v;const h=[],g=mt(this.modelId),r=e.type;c!=null&&h.push({type:"unsupported-setting",setting:"topK"}),a!=null&&h.push({type:"unsupported-setting",setting:"seed"}),t!=null&&h.push({type:"unsupported-setting",setting:"presencePenalty"}),s!=null&&h.push({type:"unsupported-setting",setting:"frequencyPenalty"}),d!=null&&h.push({type:"unsupported-setting",setting:"stopSequences"});const{messages:b,warnings:I}=Be({prompt:l,systemMessageMode:g.systemMessageMode});h.push(...I);const k=ee({provider:"openai",providerOptions:_,schema:gt}),T=(f=k==null?void 0:k.strictSchemas)!=null?f:!0,O={model:this.modelId,input:b,temperature:i,top_p:u,max_output_tokens:n,...(m==null?void 0:m.type)==="json"&&{text:{format:m.schema!=null?{type:"json_schema",strict:T,name:(C=m.name)!=null?C:"response",description:m.description,schema:m.schema}:{type:"json_object"}}},metadata:k==null?void 0:k.metadata,parallel_tool_calls:k==null?void 0:k.parallelToolCalls,previous_response_id:k==null?void 0:k.previousResponseId,store:k==null?void 0:k.store,user:k==null?void 0:k.user,instructions:k==null?void 0:k.instructions,...g.isReasoningModel&&((k==null?void 0:k.reasoningEffort)!=null||(k==null?void 0:k.reasoningSummary)!=null)&&{reasoning:{...(k==null?void 0:k.reasoningEffort)!=null&&{effort:k.reasoningEffort},...(k==null?void 0:k.reasoningSummary)!=null&&{summary:k.reasoningSummary}}},...g.requiredAutoTruncation&&{truncation:"auto"}};switch(g.isReasoningModel&&(O.temperature!=null&&(O.temperature=void 0,h.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),O.top_p!=null&&(O.top_p=void 0,h.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),r){case"regular":{const{tools:N,tool_choice:w,toolWarnings:x}=ze({mode:e,strict:T});return{args:{...O,tools:N,tool_choice:w},warnings:[...h,...x]}}case"object-json":return{args:{...O,text:{format:e.schema!=null?{type:"json_schema",strict:T,name:(v=e.name)!=null?v:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:h};case"object-tool":return{args:{...O,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:T}]},warnings:h};default:{const N=r;throw new Error(`Unsupported type: ${N}`)}}}async doGenerate(e){var n,i,d,u,c,t,s;const{args:a,warnings:l}=this.getArgs(e),_=this.config.url({path:"/responses",modelId:this.modelId}),{responseHeaders:m,value:f,rawValue:C}=await E({url:_,headers:$(this.config.headers(),e.headers),body:a,failedResponseHandler:D,successfulResponseHandler:F(p({id:o(),created_at:y(),error:p({message:o(),code:o()}).nullish(),model:o(),output:R(ne("type",[p({type:S("message"),role:S("assistant"),content:R(p({type:S("output_text"),text:o(),annotations:R(p({type:S("url_citation"),start_index:y(),end_index:y(),url:o(),title:o()}))}))}),p({type:S("function_call"),call_id:o(),name:o(),arguments:o()}),p({type:S("web_search_call")}),p({type:S("computer_call")}),p({type:S("reasoning"),summary:R(p({type:S("summary_text"),text:o()}))})])),incomplete_details:p({reason:o()}).nullable(),usage:ge})),abortSignal:e.abortSignal,fetch:this.config.fetch});if(f.error)throw new ke({message:f.error.message,url:_,requestBodyValues:a,statusCode:400,responseHeaders:m,responseBody:C,isRetryable:!1});const v=f.output.filter(r=>r.type==="message").flatMap(r=>r.content).filter(r=>r.type==="output_text"),h=f.output.filter(r=>r.type==="function_call").map(r=>({toolCallType:"function",toolCallId:r.call_id,toolName:r.name,args:r.arguments})),g=(i=(n=f.output.find(r=>r.type==="reasoning"))==null?void 0:n.summary)!=null?i:null;return{text:v.map(r=>r.text).join(`
`),sources:v.flatMap(r=>r.annotations.map(b=>{var I,k,T;return{sourceType:"url",id:(T=(k=(I=this.config).generateId)==null?void 0:k.call(I))!=null?T:L(),url:b.url,title:b.title}})),finishReason:pe({finishReason:(d=f.incomplete_details)==null?void 0:d.reason,hasToolCalls:h.length>0}),toolCalls:h.length>0?h:void 0,reasoning:g?g.map(r=>({type:"text",text:r.text})):void 0,usage:{promptTokens:f.usage.input_tokens,completionTokens:f.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:m,body:C},request:{body:JSON.stringify(a)},response:{id:f.id,timestamp:new Date(f.created_at*1e3),modelId:f.model},providerMetadata:{openai:{responseId:f.id,cachedPromptTokens:(c=(u=f.usage.input_tokens_details)==null?void 0:u.cached_tokens)!=null?c:null,reasoningTokens:(s=(t=f.usage.output_tokens_details)==null?void 0:t.reasoning_tokens)!=null?s:null}},warnings:l}}async doStream(e){const{args:n,warnings:i}=this.getArgs(e),{responseHeaders:d,value:u}=await E({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:$(this.config.headers(),e.headers),body:{...n,stream:!0},failedResponseHandler:D,successfulResponseHandler:te(ot),abortSignal:e.abortSignal,fetch:this.config.fetch}),c=this;let t="unknown",s=NaN,a=NaN,l=null,_=null,m=null;const f={};let C=!1;return{stream:u.pipeThrough(new TransformStream({transform(v,h){var g,r,b,I,k,T,O,N;if(!v.success){t="error",h.enqueue({type:"error",error:v.error});return}const w=v.value;if(pt(w))w.item.type==="function_call"&&(f[w.output_index]={toolName:w.item.name,toolCallId:w.item.call_id},h.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:w.item.call_id,toolName:w.item.name,argsTextDelta:w.item.arguments}));else if(ut(w)){const x=f[w.output_index];x!=null&&h.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:x.toolCallId,toolName:x.toolName,argsTextDelta:w.delta})}else rt(w)?(m=w.response.id,h.enqueue({type:"response-metadata",id:w.response.id,timestamp:new Date(w.response.created_at*1e3),modelId:w.response.model})):at(w)?h.enqueue({type:"text-delta",textDelta:w.delta}):dt(w)?h.enqueue({type:"reasoning",textDelta:w.delta}):it(w)&&w.item.type==="function_call"?(f[w.output_index]=void 0,C=!0,h.enqueue({type:"tool-call",toolCallType:"function",toolCallId:w.item.call_id,toolName:w.item.name,args:w.item.arguments})):lt(w)?(t=pe({finishReason:(g=w.response.incomplete_details)==null?void 0:g.reason,hasToolCalls:C}),s=w.response.usage.input_tokens,a=w.response.usage.output_tokens,l=(b=(r=w.response.usage.input_tokens_details)==null?void 0:r.cached_tokens)!=null?b:l,_=(k=(I=w.response.usage.output_tokens_details)==null?void 0:I.reasoning_tokens)!=null?k:_):ct(w)?h.enqueue({type:"source",source:{sourceType:"url",id:(N=(O=(T=c.config).generateId)==null?void 0:O.call(T))!=null?N:L(),url:w.annotation.url,title:w.annotation.title}}):ht(w)&&h.enqueue({type:"error",error:w})},flush(v){v.enqueue({type:"finish",finishReason:t,usage:{promptTokens:s,completionTokens:a},...(l!=null||_!=null)&&{providerMetadata:{openai:{responseId:m,cachedPromptTokens:l,reasoningTokens:_}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:d},request:{body:JSON.stringify(n)},warnings:i}}},ge=p({input_tokens:y(),input_tokens_details:p({cached_tokens:y().nullish()}).nullish(),output_tokens:y(),output_tokens_details:p({reasoning_tokens:y().nullish()}).nullish()}),Ke=p({type:S("response.output_text.delta"),delta:o()}),Ye=p({type:se(["response.completed","response.incomplete"]),response:p({incomplete_details:p({reason:o()}).nullish(),usage:ge})}),Qe=p({type:S("response.created"),response:p({id:o(),created_at:y(),model:o()})}),Xe=p({type:S("response.output_item.done"),output_index:y(),item:ne("type",[p({type:S("message")}),p({type:S("function_call"),id:o(),call_id:o(),name:o(),arguments:o(),status:S("completed")})])}),Ze=p({type:S("response.function_call_arguments.delta"),item_id:o(),output_index:y(),delta:o()}),et=p({type:S("response.output_item.added"),output_index:y(),item:ne("type",[p({type:S("message")}),p({type:S("function_call"),id:o(),call_id:o(),name:o(),arguments:o()})])}),tt=p({type:S("response.output_text.annotation.added"),annotation:p({type:S("url_citation"),url:o(),title:o()})}),nt=p({type:S("response.reasoning_summary_text.delta"),item_id:o(),output_index:y(),summary_index:y(),delta:o()}),st=p({type:S("error"),code:o(),message:o(),param:o().nullish(),sequence_number:y()}),ot=K([Ke,Ye,Qe,Xe,Ze,et,tt,nt,st,p({type:o()}).passthrough()]);function at(e){return e.type==="response.output_text.delta"}function it(e){return e.type==="response.output_item.done"}function lt(e){return e.type==="response.completed"||e.type==="response.incomplete"}function rt(e){return e.type==="response.created"}function ut(e){return e.type==="response.function_call_arguments.delta"}function pt(e){return e.type==="response.output_item.added"}function ct(e){return e.type==="response.output_text.annotation.added"}function dt(e){return e.type==="response.reasoning_summary_text.delta"}function ht(e){return e.type==="error"}function mt(e){return e.startsWith("o")||e.startsWith("gpt-5")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1}}var gt=p({metadata:de().nullish(),parallelToolCalls:X().nullish(),previousResponseId:o().nullish(),store:X().nullish(),user:o().nullish(),reasoningEffort:o().nullish(),strictSchemas:X().nullish(),instructions:o().nullish(),reasoningSummary:o().nullish()}),ft=p({});function _t({searchContextSize:e,userLocation:n}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:n},parameters:ft}}var yt={webSearchPreview:_t},vt=p({instructions:o().nullish(),speed:y().min(.25).max(4).default(1).nullish()}),bt=class{constructor(e,n){this.modelId=e,this.config=n,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({text:e,voice:n="alloy",outputFormat:i="mp3",speed:d,instructions:u,providerOptions:c}){const t=[],s=ee({provider:"openai",providerOptions:c,schema:vt}),a={model:this.modelId,input:e,voice:n,response_format:"mp3",speed:d,instructions:u};if(i&&(["mp3","opus","aac","flac","wav","pcm"].includes(i)?a.response_format=i:t.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${i}. Using mp3 instead.`})),s){const l={};for(const _ in l){const m=l[_];m!==void 0&&(a[_]=m)}}return{requestBody:a,warnings:t}}async doGenerate(e){var n,i,d;const u=(d=(i=(n=this.config._internal)==null?void 0:n.currentDate)==null?void 0:i.call(n))!=null?d:new Date,{requestBody:c,warnings:t}=this.getArgs(e),{value:s,responseHeaders:a,rawValue:l}=await E({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:$(this.config.headers(),e.headers),body:c,failedResponseHandler:D,successfulResponseHandler:xe(),abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:s,warnings:t,request:{body:JSON.stringify(c)},response:{timestamp:u,modelId:this.modelId,headers:a,body:l}}}};function wt(e={}){var n,i,d;const u=(n=fe(e.baseURL))!=null?n:"https://api.openai.com/v1",c=(i=e.compatibility)!=null?i:"compatible",t=(d=e.name)!=null?d:"openai",s=()=>({Authorization:`Bearer ${be({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),a=(r,b={})=>new Se(r,b,{provider:`${t}.chat`,url:({path:I})=>`${u}${I}`,headers:s,compatibility:c,fetch:e.fetch}),l=(r,b={})=>new Ne(r,b,{provider:`${t}.completion`,url:({path:I})=>`${u}${I}`,headers:s,compatibility:c,fetch:e.fetch}),_=(r,b={})=>new De(r,b,{provider:`${t}.embedding`,url:({path:I})=>`${u}${I}`,headers:s,fetch:e.fetch}),m=(r,b={})=>new Le(r,b,{provider:`${t}.image`,url:({path:I})=>`${u}${I}`,headers:s,fetch:e.fetch}),f=r=>new We(r,{provider:`${t}.transcription`,url:({path:b})=>`${u}${b}`,headers:s,fetch:e.fetch}),C=r=>new bt(r,{provider:`${t}.speech`,url:({path:b})=>`${u}${b}`,headers:s,fetch:e.fetch}),v=(r,b)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return r==="gpt-3.5-turbo-instruct"?l(r,b):a(r,b)},h=r=>new Ge(r,{provider:`${t}.responses`,url:({path:b})=>`${u}${b}`,headers:s,fetch:e.fetch}),g=function(r,b){return v(r,b)};return g.languageModel=v,g.chat=a,g.completion=l,g.responses=h,g.embedding=_,g.textEmbedding=_,g.textEmbeddingModel=_,g.image=m,g.imageModel=m,g.transcription=f,g.transcriptionModel=f,g.speech=C,g.speechModel=C,g.tools=yt,g}var xt=wt({compatibility:"strict"});export{wt as createOpenAI,xt as openai};
